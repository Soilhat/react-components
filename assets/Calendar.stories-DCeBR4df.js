import{j as n}from"./jsx-runtime-u17CrQMm.js";import{r as f}from"./iframe-BuCwFFXo.js";import{B as x}from"./Button-Czi8p-tv.js";import"./preload-helper-PPVm8Dsz.js";function B(e){return e<10?`0${e}`:`${e}`}function h(e){return`${e.getFullYear()}-${B(e.getMonth()+1)}-${B(e.getDate())}`}function ee(e,o){const u=new Date(e,o,1),s=new Date(e,o+1,0),r=[],d=new Date(u);d.setDate(u.getDate()-d.getDay());const l=new Date(s);l.setDate(s.getDate()+(6-l.getDay()));for(let a=new Date(d);a<=l;a.setDate(a.getDate()+1))r.push(new Date(a));const c=[];for(let a=0;a<r.length;a+=7)c.push(r.slice(a,a+7));return c}function te(e){if(typeof e!="object"||e===null)return null;const o=e;return Array.isArray(o.items)?o.items:Array.isArray(o.events)?o.events:null}function M(e){if(e!=null){if(typeof e=="string"||typeof e=="number")return String(e);if(typeof e=="object"){const o=e;if(typeof o.title=="string")return o.title;if(typeof o.name=="string")return o.name}}}function ne(e){const o=[];if(!Array.isArray(e)||e.length===0)return o;function u(s,r,d){for(const[l,c]of r.entries()){const a=s?.id?`${s.id}-${l}`:`evt-${d}-${l}`;o.push({id:s?.id,title:M(c)??`item-${l}`,key:a})}}for(const[s,r]of e.entries()){if(r==null)continue;const d=te(r);if(d?.length){u(r??void 0,d,s);continue}if(typeof r=="object"){const c=r,a=c.id??`evt-${s}`,y=c.title??c.name??M(c)??a;o.push({id:a,title:y,key:a});continue}const l=`evt-${s}`;o.push({id:l,title:M(r)??l,key:l})}return o}const oe=({dayEvents:e,onEventClick:o})=>{const u=ne(e??[]);return u.length===0?null:n.jsx("div",{className:"flex flex-col gap-1.5 w-full",children:u.map(s=>n.jsx(x,{onClick:()=>s.id&&o?.(s.id),title:s.title,"aria-label":s.title,color_name:"light",className:"text-left text-xs p-1.5 w-full h-auto min-h-fit leading-tight border-none bg-primary/10 hover:bg-primary/20 text-primary-dark dark:text-primary",children:n.jsx("div",{className:"line-clamp-2 break-words overflow-hidden",children:s.title})},s.key))})},_=({d:e,isCurrentMonth:o,dayEvents:u,actionLabel:s,onAction:r,onEventClick:d,containerClass:l,id:c})=>{const a=h(e),y=e.toLocaleDateString(void 0,{weekday:"short"}),i=h(new Date)===a;return n.jsxs("div",{id:c,className:`${l} border rounded-xl p-3 transition-all ${i?"ring-2 ring-primary border-primary bg-primary/5 shadow-md":o?"bg-surface-panel dark:bg-surface-panel-dark shadow-sm":"bg-surface-base/50 dark:bg-surface-base-dark/50 opacity-60"} border-border dark:border-border-dark flex flex-col gap-2`,children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-baseline gap-2",children:[n.jsx("span",{className:`text-lg font-bold ${i?"text-primary":o?"text-text-primary dark:text-text-primary-dark":"text-text-secondary"}`,children:e.getDate()}),n.jsx("span",{className:"sm:hidden text-xs font-medium uppercase tracking-wider text-text-secondary",children:y}),i&&n.jsx("span",{className:"text-[10px] font-bold text-primary uppercase ml-1",children:"Today"})]}),n.jsx(x,{type:"button",onClick:()=>r?.(e),color_name:"primary",className:"py-1 px-3 text-[10px] h-7 w-auto!",children:s})]}),n.jsx("div",{className:"flex-1",children:n.jsx(oe,{dayEvents:u,onEventClick:d})})]},a)};function j({year:e,month:o,title:u,onPrev:s,onNext:r,onAction:d,onEventClick:l,eventsByDate:c={},actionLabel:a="Plan",initialView:y}){const[i,w]=f.useState(new Date(e,o,1)),[g,S]=f.useState(y??"month"),[O,q]=f.useState(!1),[T,z]=f.useState(null),[E,$]=f.useState(null),A=50;f.useEffect(()=>{const t=()=>{window.innerWidth<640&&q(window.scrollY>300)};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]);const F=()=>{if(g==="month")w(new Date(i.getFullYear(),i.getMonth()-1,1));else{const t=new Date(i);t.setDate(t.getDate()-7),w(t)}s?.()},P=()=>{if(g==="month")w(new Date(i.getFullYear(),i.getMonth()+1,1));else{const t=new Date(i);t.setDate(t.getDate()+7),w(t)}r?.()},X=t=>{$(null),z(t.targetTouches[0].clientX)},G=t=>$(t.targetTouches[0].clientX),H=()=>{if(!T||!E)return;const t=T-E,v=t>A,p=t<-A;v&&P(),p&&F()},Y=()=>{const t=new Date;(i.getMonth()!==t.getMonth()||i.getFullYear()!==t.getFullYear())&&w(new Date(t.getFullYear(),t.getMonth(),1)),setTimeout(()=>{const v=`mob-${h(t)}`,p=document.getElementById(v);if(p){const U=document.body.getBoundingClientRect().top,Z=p.getBoundingClientRect().top-U-100;window.scrollTo({top:Z,behavior:"smooth"})}},100)},J=ee(i.getFullYear(),i.getMonth()).flat(),N=new Date(i);N.setDate(i.getDate()-i.getDay());const K=Array.from({length:7},(t,v)=>{const p=new Date(N);return p.setDate(N.getDate()+v),p}),C=g==="month"?J:K,Q=g==="month"?C.filter(t=>t.getMonth()===i.getMonth()):C;return n.jsxs("div",{className:"w-full max-w-full overflow-hidden relative touch-pan-y",onTouchStart:X,onTouchMove:G,onTouchEnd:H,children:[O&&n.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 sm:hidden",children:n.jsx(x,{onClick:Y,color_name:"primary",className:"shadow-2xl px-6 py-3 rounded-full font-bold animate-in fade-in slide-in-from-bottom-4",children:"Go to Today"})}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:u??`${i.toLocaleString(void 0,{month:"long",year:"numeric"})}`}),n.jsx(x,{onClick:Y,color_name:"light",className:"hidden sm:flex text-[10px] px-2 h-7 py-0 uppercase font-bold tracking-wider",children:"Today"})]}),n.jsxs("div",{className:"flex items-center justify-between sm:justify-end gap-2",children:[n.jsxs("div",{className:"flex bg-surface-panel dark:bg-surface-panel-dark p-1 rounded-lg border border-border dark:border-border-dark",children:[n.jsx("button",{onClick:()=>S("month"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${g==="month"?"bg-primary text-white shadow-md":"text-text-secondary"}`,children:"Month"}),n.jsx("button",{onClick:()=>S("week"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${g==="week"?"bg-primary text-white shadow-md":"text-text-secondary"}`,children:"Week"})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(x,{onClick:F,color_name:"light",className:"px-3",children:"Prev"}),n.jsx(x,{onClick:P,color_name:"light",className:"px-3",children:"Next"})]})]})]}),n.jsx("div",{className:"hidden sm:grid sm:grid-cols-7 gap-3 mb-2 px-1 text-center",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>n.jsx("div",{className:"text-xs font-bold uppercase tracking-widest text-text-secondary opacity-70",children:t},t))}),n.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-7",children:[n.jsx("div",{className:"contents sm:hidden",children:Q.map(t=>n.jsx(_,{id:`mob-${h(t)}`,d:t,isCurrentMonth:t.getMonth()===i.getMonth(),dayEvents:c[h(t)]??[],actionLabel:a,onAction:d,onEventClick:l,containerClass:"min-h-[5rem]"},`mob-${h(t)}`))}),n.jsx("div",{className:"hidden sm:contents",children:C.map(t=>n.jsx(_,{d:t,isCurrentMonth:t.getMonth()===i.getMonth(),dayEvents:c[h(t)]??[],actionLabel:a,onAction:d,onEventClick:l,containerClass:g==="week"?"min-h-[12rem]":"min-h-[8rem]"},`dt-${h(t)}`))})]})]})}j.__docgenInfo={description:"",methods:[],displayName:"Calendar",props:{eventsByDate:{defaultValue:{value:"{}",computed:!1},required:!1},actionLabel:{defaultValue:{value:"'Plan'",computed:!1},required:!1}}};const ue={title:"Data Display/Calendar",component:j,parameters:{layout:"centered"}},m=new Date,D=e=>e.toISOString().slice(0,10),L=new Date(m);L.setDate(m.getDate()+1);const R=new Date(m);R.setDate(m.getDate()+3);const V=new Date(m);V.setDate(m.getDate()-2);const W=new Date(m);W.setDate(m.getDate()+7);const I={[D(m)]:[{id:"evt-today-1",title:"Team Meeting"},{id:"evt-today-2",title:"1:1",items:[{title:"Discuss roadmap for long text implementation"}]}],[D(L)]:[{id:"evt-tomorrow-1",title:"Deploy"}],[D(R)]:[{id:"evt-deadline",title:"Project Deadline"},{id:"evt-workshop",title:"Workshop",items:[{title:"Prep"},{title:"Run"}]}],[D(V)]:[{id:"evt-past",title:"Client Call"}],[D(W)]:[{id:"evt-events-1",events:[{name:"Recipe A"},{name:"Recipe B"}]}]},b={render:()=>n.jsx(j,{year:m.getFullYear(),month:m.getMonth(),eventsByDate:I,onAction:e=>console.log("onAction",e),onEventClick:e=>console.log("onEventClick",e),actionLabel:"Plan"})},k={render:()=>n.jsx(j,{year:m.getFullYear(),month:m.getMonth(),initialView:"week",eventsByDate:I,onAction:e=>console.log("onAction",e),onEventClick:e=>console.log("onEventClick",e),actionLabel:"Plan"})};b.parameters={...b.parameters,docs:{...b.parameters?.docs,source:{originalSource:`{
  render: () => <Calendar year={today.getFullYear()} month={today.getMonth()} eventsByDate={sampleEvents} onAction={d => console.log('onAction', d)} onEventClick={id => console.log('onEventClick', id)} actionLabel="Plan" />
}`,...b.parameters?.docs?.source}}};k.parameters={...k.parameters,docs:{...k.parameters?.docs,source:{originalSource:`{
  render: () => <Calendar year={today.getFullYear()} month={today.getMonth()} initialView="week" eventsByDate={sampleEvents} onAction={d => console.log('onAction', d)} onEventClick={id => console.log('onEventClick', id)} actionLabel="Plan" />
}`,...k.parameters?.docs?.source}}};const he=["MonthView","WeekView"];export{b as MonthView,k as WeekView,he as __namedExportsOrder,ue as default};
